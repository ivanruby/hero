(function(){"use strict";function n(e){var n={tables:[],url:"",id:"",syncOnSave:true,storageEngine:"localStorage"};var r=n;if(t.db._options.tables)r.tables=t.db._options.tables.slice();if(e){if(typeof e==="string"){r.tables.push(e);if(!localStorage.getItem(e))localStorage.setItem(e,"")}else if(typeof e==="object"){if(Object.prototype.toString.call(e)==="[object Array]"){for(var i=0;i<e.length;i++)r.tables.push(e[i])}else{for(var s in e){switch(s){case"tables":if(typeof e[s]==="array")for(var i=0;i<e[s].length;i++){r.tables.push(e[s][i])}else r.tables.push(e[s]);break;case"id":r.id=e[s];break;case"url":r.url=e[s];break;case"syncOnSave":r=e[s];break;case"storageEngine":r.storageEngine=e[s];break;default:t.log("Invalid property: "+s,"error")}}}}else{t.log("ERROR: typeof options: "+typeof options+"\n Expected: string or object")}}t.db._options=r}function r(e){this._query.table=e;return this}function i(e){this._query.mode="insert";this._query.insertData=e;return this}function s(e){this._query.mode="update";this._query.updateData=e;return this}function o(e){this._query.mode="delete";this._query.condition=e;return this}function u(e){this._query.mode="truncate";this._query.table=e;return this}function a(e){this._query.condition=e;return this}function f(e){this._query.sortingProperty=e;return this}function l(e){this._query.searchingModel=e;this._query.mode="search";return this}function c(e){var n=false;var r=this._query.table;if(e){if(h(e)){if(this._query.sortingProperty){var i=b(e,this._query.sortingProperty);this._query={};return i}else return d(e)}else t.log("TABLE IS NOT REGISTERED OR DOES NOT EXIST IN DATABASE","error")}else{if(h(r)){switch(this._query.mode){case"insert":var s=m(r,this._query.insertData);if(!s)this._error.push("ERROR IN INSERTING ELEMENT. "+"TABLE MIGHT NOT EXIST OR "+"LOGICAL ERROR IN THE LIBRARY");break;case"delete":var o=false;var u=[];if(!p(r)){var u=y(r,this._query.condition);if(u.length>0)v(r,u);else this._error.push("ELEMENT TO BE DELETED NOT FOUND")}else{this._error.push("TABLE IS EMPTY")}break;case"truncate":localStorage.setItem(r,"");t.log("Table "+r+" truncated");break;case"update":n=g(r,this._query.condition,this._query.updateData);break;case"search":var i=y(r,this._query.searchingModel);return i.length>0;break;default:if(this._query.sortingProperty){var i=b(r,this._query.sortingProperty);this._query={};return i}else return d(r)}}else{this._error.push("TABLE IS NOT REGISTERED OR DOES NOT EXIST IN DATABASE")}}if(this._error.length>0)for(var a=0;a<this._error.length;a++)t.log(this._error[a],"error");else n=true;this._query={};this._error=[];return n}function h(e){var n=t.db._options.tables;if(n){for(var r=0;r<n.length;r++)if(e===n[r])return true;return false}else return false}function p(e){if(localStorage.getItem(e)=="")return true;else return false}function d(e){var t=localStorage.getItem(e).split(";");if(p(e))return[];for(var n=0;n<t.length;n++)t[n]=JSON.parse(t[n]);return t}function v(e,t){var n=false,r=0;if(t.length>0){if(!p(e)){var i=d(e),s=[];for(var o=0;o<t.length;o++){i[t[o]]="#_$";r++}for(var o=0;o<i.length;o++){if(i[o]!="#_$")s.push(i[o])}}else n=false}t.length-=r;if(t.length==0){n=true;localStorage.setItem(e,"");for(var o=0;o<s.length;o++)m(e,s[o])}return n}function m(e,t,n){var r=false;if(h(e)){var i=[],s=d(e);if(s.length>0){if(s[0]!=""){for(var o=0;o<s.length;o++)i.push(JSON.stringify(s[o]))}}i.push(JSON.stringify(t));localStorage.setItem(e,i.join(";"));r=true}else r=false;return r}function g(e,t,n){var r=false,i=d(e);if(i.length>0){var s,o,u,a;for(var f in t){s=f;o=t[f]}for(var f in n){u=f;a=n[f]}i.forEach(function(e,t,n){if(e.hasOwnProperty(s)){if(e[s]===o){if(e.hasOwnProperty(u)){e[u]=a;r=true}}}})}if(r){localStorage.setItem(e,"");for(var l=0;l<i.length;l++)m(e,i[l])}return r}function y(e,t){var n=[],r=d(e);if(r.length>0){var i,s;for(var o in t){i=o;s=t[o]}r.forEach(function(e,t,r){if(e.hasOwnProperty(i)){if(e[i]===s){n.push(t)}}})}return n}function b(e,t){var n=[],r=d(e);if(r.length>0){for(var i=0;i<r.length;i++){for(var s=0;s<r.length-1;s++){if(r[s][t]>r[s+1][t]){var o=r[s];r[s]=r[s+1];r[s+1]=o}}}}n=r.slice();return n}function w(e){var n=e||"app";n+=".appcache";t.cache._options.name=n;return this}function E(e){if(e){if(typeof e==="string")t.cache._options.require=e;else t.cache._options.require=e.slice()}else t.cache._options.require=[];return this}function S(e){if(e){if(typeof e==="string")t.cache._options.network=e;else t.cache._options.network=e.slice()}else t.cache._options.network=[];return this}function x(e){if(e){if(typeof e==="string")t.cache._options.fallback=e;else t.cache._options.fallback=e.slice()}else t.cache._options.fallback=[];return this}function T(){var e,n,r,i;if(typeof t.cache._options.require==="string")n=t.cache._options.require;else n=t.cache._options.network.join("\n");if(typeof t.cache._options.network==="string")r=t.cache._options.network;else r=t.cache._options.network.join("\n");if(typeof t.cache._options.fallback==="string")i=t.cache._options.fallback;else i=t.cache._options.fallback.join("\n");e="CACHE MANIFEST\n"+n+"\n\n"+"NETWORK:\n"+r+"\n\n"+"FALLBACK:\n"+i;console.log(e);$("html").attr("cache",t.cache._options.name)}function N(){return navigator.onLine}function C(){return navigator.geolocation?true:false}function k(e){L();$(document).ajaxComplete(function(){var n=t.geo._data;e(n)})}function L(){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(A)}else{t.log("Geolocation is not supported by this browser. "+" IP LookUp will be used instead.","warn")}}function A(e){var n=e.coords.latitude;var r=e.coords.longitude;var i="https://api.metwit.com/v2/weather/?location_lat="+n+"&location_lng="+r;$.getJSON(i,function(e){t.geo._data=e.objects[1]}).fail(function(){t.geo._data=null;t.log("Unable to retrieve GeoLocation Data")})}function O(e){e=e.toUpperCase();for(var t in countries)if(e==t)return countries[t].name;return"Invalid country code"}function M(e,n){if(t._options.environment==="dev"){switch(n){case"warn":console.warn("HERO WARNS: "+e);break;case"error":console.error("HERO HAD AN ERROR: "+e);break;default:console.log("HERO SAYS: "+e)}}}function _(e){var n={environment:"dev"};t._options=e||n}var e=this;var t={VERSION:"0.5.0",_options:{environment:"dev"},config:_,log:M,db:{_query:{},_options:{},_error:[],_buffer:[],config:n,register:n,on:r,from:r,insert:i,update:s,remove:o,truncate:u,where:a,sort:f,search:l,get:c,ok:c},geo:{_data:{},init:k,isEnabled:C,countryLookUp:O},cache:{_options:{},create:w,require:E,network:S,fallback:x,generate:T},nav:{isOnline:N}};e.hero=t}).call(this)